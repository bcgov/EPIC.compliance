"""case_file status added

Revision ID: 87075ff90eab
Revises: 49cbe8cd1849
Create Date: 2024-09-06 13:48:52.411646

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = '87075ff90eab'
down_revision = '49cbe8cd1849'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    casefilestatusenum = sa.Enum('OPEN', 'CLOSED', name='casefilestatusenum', create_type=True)
    casefilestatusenum.create(op.get_bind()) 
    with op.batch_alter_table('case_files', schema=None) as batch_op:
        batch_op.add_column(sa.Column('case_file_status', sa.Enum('OPEN', 'CLOSED', name='casefilestatusenum'), nullable=True))
        batch_op.alter_column('project_id',
               existing_type=sa.INTEGER(),
               nullable=True,
               existing_comment='The unique identifier of the project associated with the case file')
    topics = [
        "Acid rock drainage",
        "Access control",
        "Air quality",
        "Approvals",
        "Camp",
        "Caribou mitigation and monitoring plan",
        "Community engagement",
        "Consultation and development",
        "Compensation or relocation",
        "Conduct works in WEP without full approval",
        "Construction staging",
        "Dust management",
        "Environmental management plan",
        "Erosion and sediment control",
        "Equipment maintenance",
        "False or misleading",
        "Fish and fish habitat",
        "Hazardous waste management",
        "Heritage Resources",
        "Human-Wildlife Conflict Mitigation",
        "Hydrocarbon management",
        "Indigenous consultation",
        "Infestation mitigation",
        "Invasive plant management",
        "Monitoring",
        "Noise and vibration",
        "Non-hazardous waste management",
        "Open burning",
        "Preconstruction requirements",
        "Public engagement",
        "Records management",
        "Signage",
        "Site maintenance",
        "Site reclamation",
        "Social management plan",
        "Social and economic effects reporting",
        "Soil salvage",
        "Spill management",
        "Timber salvage",
        "Training",
        "Waste management",
        "Water quality",
        "Water management",
        "WEP - Phase 2 implementation",
        "WEP - Final Clean-up implementation",
        "Whitebark pine",
        "Wildlife mitigation",
        "Wildlife monitoring",
        "Wildlife attractant management",
    ]
    op.execute(sa.text("TRUNCATE topics RESTART IDENTITY"))
    for value in topics:
        op.execute(
            f"INSERT INTO topics (name, created_date, created_by) VALUES ('{value}', now() at time zone 'utc','system')"
        )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    with op.batch_alter_table('case_files', schema=None) as batch_op:
        batch_op.alter_column('project_id',
               existing_type=sa.INTEGER(),
               nullable=False,
               existing_comment='The unique identifier of the project associated with the case file')
        batch_op.drop_column('case_file_status')

    # ### end Alembic commands ###
